# CodeQL Configuration for Swift Security Scanning

version: 2.0.0

query-filters:
  # Include security and quality queries
  - include:
      tags:
        - security
        - quality
  - exclude:
      tags:
        - experimental
        - deprecated

packs:
  javascript:
    version: latest
  swift:
    version: latest

paths:
  # Scan Swift source files
  include:
    - platforms/apple/swift/**/*.swift
    - platforms/apple/apps/**/*.swift

  # Exclude test files from security scanning
  exclude:
    - platforms/apple/**/Tests/**/*.swift
    - platforms/apple/**/*Tests.swift
    - platforms/apple/**/.build/**/*.swift
    - platforms/apple/**/DerivedData/**/*.swift

# Security query suites
query-suite:
  - security-extended
  - security-and-quality

# Custom query packs (if you have custom CodeQL queries)
# packs:
#   my-custom-queries:
#     path: .github/codeql/queries

# Configuration for specific Swift security checks
swift-security:
  # Enable additional checks for common vulnerabilities
  enable-checks:
    - tainted-flow
    - unsafe-code
    - weak-cryptography
    - injection
    - xss
    - sql-injection
    - path-traversal
    - insecure-data-storage
    - insufficient-entropy

  # Severity thresholds
  thresholds:
    error:
      - critical
      - high
    warning:
      - medium
    info:
      - low

# Exclude specific directories from scanning
excluded-paths:
  - .build
  - DerivedData
  - Pods
  - Carthage/Build
  - vendor
  - .swiftpm

# Override default query filters for specific queries
override-properties:
  - query: cpp/unsafe-buffers
    severity: error
  - query: swift/tainted-flow
    severity: error
