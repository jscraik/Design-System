import{r as a,j as u}from"./vendor-react-C7s9o2DG.js";const i="openai:set_globals",d=a.createContext(null);function m({host:e,children:o}){return u.jsx(d.Provider,{value:e,children:o})}function v(){const e=a.useContext(d);if(!e)throw new Error("HostProvider is missing. Wrap your app in <HostProvider />.");return e}function c(){const e=()=>typeof window<"u"?window.openai:void 0;return{mode:"embedded",get toolInput(){return e()?.toolInput},get toolOutput(){return e()?.toolOutput},get toolResponseMetadata(){return e()?.toolResponseMetadata},get callTool(){if(e()?.callTool)return(t,n)=>{const r=e();return r?.callTool?r.callTool(t,n):Promise.reject(new Error("window.openai.callTool is unavailable"))}},get sendMessage(){if(e()?.sendFollowUpMessage)return async t=>{const n=e();if(!n?.sendFollowUpMessage)throw new Error("window.openai.sendFollowUpMessage is unavailable");await n.sendFollowUpMessage({prompt:t})}},get getState(){if(e()?.getWidgetState)return()=>e()?.getWidgetState?.()},get setState(){if(e()?.setWidgetState)return t=>{e()?.setWidgetState?.(t)}},get uploadFile(){if(e()?.uploadFile)return async t=>{const n=e();if(!n?.uploadFile)throw new Error("window.openai.uploadFile is unavailable");return n.uploadFile(t)}},get getFileDownloadUrl(){if(e()?.getFileDownloadUrl)return async t=>{const n=e();if(!n?.getFileDownloadUrl)throw new Error("window.openai.getFileDownloadUrl is unavailable");return n.getFileDownloadUrl(t)}},get requestDisplayMode(){if(e()?.requestDisplayMode)return async t=>{const n=e();if(!n?.requestDisplayMode)throw new Error("window.openai.requestDisplayMode is unavailable");return n.requestDisplayMode(t)}},get requestModal(){if(e()?.requestModal)return async t=>{const n=e();if(!n?.requestModal)throw new Error("window.openai.requestModal is unavailable");return n.requestModal(t)}},get openExternal(){if(e()?.openExternal)return async t=>{const n=e();if(!n?.openExternal)throw new Error("window.openai.openExternal is unavailable");return n.openExternal(t)}},get requestClose(){const o=e();return o?.requestClose?.bind(o)},get notifyIntrinsicHeight(){const o=e();if(o?.notifyIntrinsicHeight)return t=>o.notifyIntrinsicHeight?.(t)}}}function s(e){return{mode:"standalone",async callTool(o,t){const n=await fetch(`${e}/api/${o}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP ${n.status}`);return await n.json()},async sendMessage(o){console.log("standalone send:",o)},getState:()=>null,setState:()=>{},uploadFile:async()=>{throw new Error("uploadFile is not available in standalone mode")},getFileDownloadUrl:async()=>{throw new Error("getFileDownloadUrl is not available in standalone mode")},requestDisplayMode:async()=>{},requestModal:async()=>{},openExternal:async()=>{},requestClose:()=>{},notifyIntrinsicHeight:()=>{}}}function l(e={}){return{mode:"standalone",callTool:async()=>({ok:!0}),sendMessage:async()=>{},getState:()=>null,setState:()=>{},uploadFile:async()=>({fileId:"mock-file-id"}),getFileDownloadUrl:async()=>({downloadUrl:"https://example.com/mock-file"}),requestDisplayMode:async()=>{},requestModal:async()=>{},openExternal:async()=>{},requestClose:()=>{},notifyIntrinsicHeight:()=>{},...e}}function h(e={}){const o=typeof window<"u";if(e.mode==="mock")return l(e.mockOverrides);if(e.mode==="standalone"){if(!e.apiBase)throw new Error("createHostAdapter requires apiBase for standalone mode");return s(e.apiBase)}return o&&window.openai?c():e.apiBase?s(e.apiBase):l(e.mockOverrides)}function p(e){const o=typeof window<"u";return a.useSyncExternalStore(t=>{if(!o)return()=>{};const n=r=>{r.detail?.globals?.[e]!==void 0&&t()};return window.addEventListener(i,n,{passive:!0}),()=>{window.removeEventListener(i,n)}},()=>o?window.openai?.[e]:void 0,()=>{})}function E(){return p("toolOutput")}function w(e={}){return{theme:"dark",displayMode:"inline",locale:"en-US",maxHeight:600,toolInput:{},toolOutput:{demo:!0,message:"Standalone mode: window.openai was mocked."},toolResponseMetadata:{},widgetState:null,setWidgetState:()=>{},getWidgetState:()=>null,callTool:async()=>{throw new Error("callTool is not available in standalone mode. Run this UI inside ChatGPT (Apps SDK) or provide a mock implementation.")},sendFollowUpMessage:async()=>{throw new Error("sendFollowUpMessage is not available in standalone mode. Run this UI inside ChatGPT (Apps SDK) or provide a mock implementation.")},uploadFile:async()=>({fileId:"mock-file-id"}),getFileDownloadUrl:async()=>({downloadUrl:"https://example.com/mock-file"}),requestDisplayMode:async()=>{},requestModal:async()=>{},notifyIntrinsicHeight:()=>{},openExternal:async()=>{},requestClose:()=>{},...e}}function M(e={}){typeof window>"u"||window.openai||(window.openai=w(e))}export{m as H,h as a,p as b,c,E as d,M as e,v as u};
