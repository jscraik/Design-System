import"./modulepreload-polyfill-B5Qt9EMX.js";import{r as o,j as e,c as k}from"./vendor-react-C7s9o2DG.js";/* empty css               */import{b as M}from"./openai-hooks-BWAW4MV6.js";import{u as f}from"./use-openai-global-BoyuTJe3.js";import{u as C,M as I,P as $}from"./use-widget-state-BY4DWEMi.js";import{c as y}from"./createLucideIcon-BuO2Rf-V.js";import"./index-CYBJUsK9.js";const q=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],D=y("package",q);const O=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],U=y("shopping-cart",O);const E=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],R=y("trash-2",E),F=!1,P=()=>({items:[],lastUpdated:new Date().toISOString()});function _(u,x){const l=new Map;return u.forEach(s=>{l.set(s.id,{...s})}),x.forEach(s=>{const i=l.get(s.id);i?l.set(s.id,{...i,quantity:i.quantity+s.quantity,name:s.name||i.name,price:s.price??i.price,image:s.image||i.image,description:s.description||i.description}):l.set(s.id,{...s})}),Array.from(l.values()).filter(s=>s.quantity>0)}function A(){const u=f("toolOutput"),x=f("toolResponseMetadata"),l=f("displayMode")??"inline",s=M(),[i,r]=C(P),[g,b]=o.useState(!1),h=x?.widgetSessionId;o.useEffect(()=>{if(!u)return;const{action:t,items:a}=u;if(t==="clear"){r({items:[],lastUpdated:new Date().toISOString()});return}if(t==="remove"&&a){r(d=>{const j=new Set(a.map(n=>n.id));return{items:(d?.items??[]).filter(n=>!j.has(n.id)),lastUpdated:new Date().toISOString()}});return}(t==="add"||!t)&&a&&a.length>0&&r(d=>({items:_(d?.items??[],a),lastUpdated:new Date().toISOString()}))},[u,r]);const c=o.useMemo(()=>i?.items??[],[i?.items]),p=o.useMemo(()=>c.reduce((t,a)=>t+a.price*a.quantity,0),[c]),m=o.useMemo(()=>c.reduce((t,a)=>t+a.quantity,0),[c]),v=o.useCallback((t,a)=>{b(!0),r(d=>({items:(d?.items??[]).map(n=>n.id===t?{...n,quantity:Math.max(0,n.quantity+a)}:n).filter(n=>n.quantity>0),lastUpdated:new Date().toISOString()})),setTimeout(()=>b(!1),150)},[r]),N=o.useCallback(t=>{r(a=>({items:(a?.items??[]).filter(d=>d.id!==t),lastUpdated:new Date().toISOString()}))},[r]),S=o.useCallback(()=>{r({items:[],lastUpdated:new Date().toISOString()})},[r]),w=o.useCallback(async()=>{if(!s){F&&console.warn("sendFollowUpMessage not available");return}await s(`I'd like to checkout with my cart containing ${m} items totaling $${p.toFixed(2)}`)},[m,s,p]);return e.jsxs("div",{className:"min-h-[200px] rounded-2xl border shadow-sm bg-surface border-subtle text-primary",role:"region","aria-label":"Shopping cart",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-subtle",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5","aria-hidden":"true"}),e.jsx("h2",{className:"font-semibold",id:"cart-heading",children:"Shopping Cart"}),m>0&&e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-surface-tertiary text-secondary","aria-live":"polite",children:[m," item",m!==1?"s":""]})]}),h&&e.jsxs("span",{className:"text-xs text-tertiary","aria-hidden":"true",children:["Session: ",h.slice(0,8),"..."]})]}),e.jsx("div",{className:"p-4",role:"list","aria-labelledby":"cart-heading",children:c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",role:"status",children:[e.jsx(D,{className:"w-12 h-12 text-tertiary","aria-hidden":"true"}),e.jsx("p",{className:"text-sm text-secondary",children:"Your cart is empty"}),e.jsx("p",{className:"text-xs text-tertiary",children:"Ask me to add items to your cart"})]}):e.jsx("div",{className:"space-y-3",children:c.map(t=>e.jsxs("div",{role:"listitem",className:"flex items-center gap-3 p-3 rounded-xl bg-surface-secondary",children:[t.image&&e.jsx("img",{src:t.image,alt:"","aria-hidden":"true",className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:t.name}),t.description&&e.jsx("p",{className:"text-xs truncate text-secondary",children:t.description}),e.jsxs("p",{className:"text-sm font-semibold mt-1","aria-label":`Price: $${(t.price*t.quantity).toFixed(2)}`,children:["$",(t.price*t.quantity).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-1",role:"group","aria-label":`Quantity controls for ${t.name}`,children:[e.jsx("button",{onClick:()=>v(t.id,-1),disabled:g,className:"p-1.5 rounded-full transition-colors hover:bg-surface-tertiary active:bg-surface-secondary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary","aria-label":`Decrease quantity of ${t.name}`,children:e.jsx(I,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("span",{className:"w-8 text-center text-sm font-medium","aria-label":`Quantity: ${t.quantity}`,children:t.quantity}),e.jsx("button",{onClick:()=>v(t.id,1),disabled:g,className:"p-1.5 rounded-full transition-colors hover:bg-surface-tertiary active:bg-surface-secondary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary","aria-label":`Increase quantity of ${t.name}`,children:e.jsx($,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("button",{onClick:()=>N(t.id),className:"p-1.5 rounded-full ml-2 transition-colors hover:bg-danger-soft-hover text-danger focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-danger","aria-label":`Remove ${t.name} from cart`,children:e.jsx(R,{className:"w-4 h-4","aria-hidden":"true"})})]})]},t.id))})}),c.length>0&&e.jsxs("div",{className:"px-4 py-3 border-t border-subtle",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-secondary",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold","aria-label":`Subtotal: $${p.toFixed(2)}`,children:["$",p.toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-2",role:"group","aria-label":"Cart actions",children:[e.jsx("button",{onClick:S,className:"flex-1 py-2 px-4 rounded-xl text-sm font-medium transition-colors bg-surface-secondary hover:bg-surface-tertiary text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:"Clear Cart"}),e.jsx("button",{onClick:w,className:"flex-1 py-2 px-4 rounded-xl text-sm font-medium bg-primary-solid hover:bg-primary-solid-hover text-primary-solid transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:"Checkout"})]})]}),l==="fullscreen"&&e.jsx("div",{className:"px-4 py-2 text-xs border-t border-subtle text-tertiary",children:e.jsxs("details",{children:[e.jsx("summary",{className:"cursor-pointer",children:"Debug Info"}),e.jsx("pre",{className:"mt-2 overflow-auto max-h-32",children:JSON.stringify({widgetSessionId:h,widgetState:i,toolOutput:u},null,2)})]})})]})}k.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(A,{})}));
